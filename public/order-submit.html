<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Order - Investment Game</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="panel">
        <h1>Submit Order</h1>
        <div id="orderForm">
            <div class="form-group">
                <label for="playerName">Player Name:</label>
                <input type="text" id="playerName" required>
            </div>
            
            <div class="form-group">
                <label for="orderType">Order Type:</label>
                <select id="orderType" required>
                    <option value="buy">Buy</option>
                    <option value="sell">Sell</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="fundSelect">Fund:</label>
                <select id="fundSelect" required></select>
            </div>
            
            <div class="form-group">
                <label for="shares">Number of Shares:</label>
                <input type="number" id="shares" min="1" value="1" required>
            </div>
            
            <button onclick="submitOrder()">Submit Order</button>
        </div>
        
        <div id="status" style="margin-top: 20px;"></div>
    </div>

    <!-- Hidden elements to store data -->
    <div id="dataStorage" style="display: none;"></div>
    
    <!-- Load Socket.IO client -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <!-- Load JavaScript files -->
    <script src="js/socket-client.js"></script>
    <script src="js/order-submit.js"></script>

    <script>
        // Game state
        let gameState = {
            phase: 'Markets Closed',
            timeRemaining: 60,
            funds: [],
            players: []
        };

        // Socket.IO connection
        let socket = null;

        // Initialize Socket.IO connection
        function initializeSocket() {
            socket = createSocketConnection('player');

            socket.on('initialData', (data) => {
                gameState = data;
                updateDisplay();
            });

            socket.on('fundsUpdate', (data) => {
                gameState.funds = data.funds;
                updateFundsList();
            });

            socket.on('phaseUpdate', (data) => {
                gameState.phase = data.phase;
                gameState.timeRemaining = data.timeRemaining;
                updatePhaseDisplay();
            });

            socket.on('marketEvent', (data) => {
                addEvent({
                    title: data.event,
                    description: `Impact on ${data.fundId}`,
                    impact: data.newPrice
                });
            });
        }

        // Submit order
        function submitOrder(event) {
            event.preventDefault();
            
            const playerName = document.getElementById('playerName').value;
            const fundId = document.getElementById('fundSelect').value;
            const shares = parseInt(document.getElementById('shares').value);
            const orderType = document.getElementById('orderType').value;
            
            if (!playerName || !fundId || isNaN(shares) || shares <= 0) {
                alert('Please fill in all fields correctly');
                return;
            }
            
            const order = {
                playerName,
                fundId,
                shares,
                orderType
            };
            
            socket.emit('order', { order });
            
            // Clear form
            document.getElementById('shares').value = '';
            
            // Show confirmation
            alert('Order submitted successfully!');
        }

        // Initialize when the page loads
        window.addEventListener('load', initializeSocket);
    </script>
</body>
</html> 